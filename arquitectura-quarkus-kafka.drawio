<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.7">
  <diagram id="arquitectura-quarkus-kafka" name="Arquitectura Quarkus Kafka">
    <mxGraphModel dx="2826" dy="629" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="yefErlVyRdIp48LVm5pq-4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="640" width="1690" x="-20" y="70" as="geometry" />
        </mxCell>
        <mxCell id="title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" value="Arquitectura Event-Driven: Quarkus + Kafka" vertex="1">
          <mxGeometry height="40" width="600" x="500" y="20" as="geometry" />
        </mxCell>
        <mxCell id="kafka-cluster" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1" value="Apache Kafka Cluster" vertex="1">
          <mxGeometry height="60" width="400" x="600" y="100" as="geometry" />
        </mxCell>
        <mxCell id="topic-create" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1" value="Topic: createOrderService" vertex="1">
          <mxGeometry height="40" width="180" x="620" y="180" as="geometry" />
        </mxCell>
        <mxCell id="topic-validated" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1" value="Topic: orderValidated" vertex="1">
          <mxGeometry height="40" width="160" x="820" y="180" as="geometry" />
        </mxCell>
        <mxCell id="orders-container" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1" value="orders-service" vertex="1">
          <mxGeometry height="40" width="480" x="80" y="280" as="geometry" />
        </mxCell>
        <mxCell id="order-resource" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11" value="OrderResource&#xa;POST /orders/create" vertex="1">
          <mxGeometry height="60" width="140" x="90" y="340" as="geometry" />
        </mxCell>
        <mxCell id="order-service" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11" value="OrderService&#xa;(Business Logic)" vertex="1">
          <mxGeometry height="60" width="140" x="260" y="340" as="geometry" />
        </mxCell>
        <mxCell id="order-repo" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11" value="OrderRepository&#xa;(Panache)" vertex="1">
          <mxGeometry height="60" width="120" x="420" y="340" as="geometry" />
        </mxCell>
        <mxCell id="order-producer" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11" value="OrderProducer&#xa;(Kafka Producer)" vertex="1">
          <mxGeometry height="60" width="140" x="100" y="480" as="geometry" />
        </mxCell>
        <mxCell id="order-consumer" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11" value="OrderValidatedConsumer&#xa;(Kafka Consumer)" vertex="1">
          <mxGeometry height="60" width="180" x="390" y="530" as="geometry" />
        </mxCell>
        <mxCell id="h2-orders" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11" value="H2 Database&#xa;orders&#xa;(./target/h2db/orders)" vertex="1">
          <mxGeometry height="80" width="60" x="640" y="330" as="geometry" />
        </mxCell>
        <mxCell id="delivery-container" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1" value="stock-service" vertex="1">
          <mxGeometry height="40" width="480" x="1040" y="280" as="geometry" />
        </mxCell>
        <mxCell id="delivery-consumer" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11" value="StockConsumer&lt;br&gt;(Kafka Consumer)" vertex="1">
          <mxGeometry height="60" width="160" x="1060" y="340" as="geometry" />
        </mxCell>
        <mxCell id="stock-service" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11" value="StockService&lt;br&gt;(Inventory Validation)" vertex="1">
          <mxGeometry height="60" width="160" x="1390" y="340" as="geometry" />
        </mxCell>
        <mxCell id="inventory-repo" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11" value="InventoryRepository&#xa;(Panache)" vertex="1">
          <mxGeometry height="60" width="160" x="1430" y="500" as="geometry" />
        </mxCell>
        <mxCell id="delivery-producer" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11" value="StockValidatedProducer&lt;br&gt;(Kafka Producer)" vertex="1">
          <mxGeometry height="60" width="180" x="1030" y="510" as="geometry" />
        </mxCell>
        <mxCell id="h2-delivery" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11" value="H2 Database&#xa;delivery&#xa;(./target/h2db/delivery)" vertex="1">
          <mxGeometry height="80" width="60" x="1290" y="600" as="geometry" />
        </mxCell>
        <mxCell id="client" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1" value="Cliente HTTP" vertex="1">
          <mxGeometry height="40" width="120" x="110" y="90" as="geometry" />
        </mxCell>
        <mxCell id="edge1" edge="1" parent="1" source="client" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;fontSize=10;curved=0;" target="order-resource" value="HTTP POST">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="170" y="180" />
              <mxPoint x="170" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge2" edge="1" parent="1" source="order-resource" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1" target="order-service" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge3" edge="1" parent="1" source="order-service" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1" target="order-repo" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge4" edge="1" parent="1" source="order-repo" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;fontSize=10;curved=0;" target="h2-orders" value="persist()">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge5" edge="1" parent="1" source="order-service" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;curved=0;" target="order-producer" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="330" y="490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge6" edge="1" parent="1" source="order-producer" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#2D7600;endArrow=block;endFill=1;fontSize=11;fontStyle=1;curved=0;dashed=1;fillColor=#60a917;" target="topic-create" value="OrderCreatedEvent">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="730" y="510" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge7" edge="1" parent="1" source="topic-create" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#2D7600;endArrow=block;endFill=1;fontSize=11;fontStyle=1;curved=0;dashed=1;fillColor=#60a917;" target="delivery-consumer" value="OrderCreatedEvent">
          <mxGeometry relative="1" x="-0.619" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="790" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge8" edge="1" parent="1" source="delivery-consumer" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;fontSize=10" target="stock-service" value="validate()">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge9" edge="1" parent="1" source="stock-service" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;fontSize=10" target="inventory-repo" value="check stock">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1510" y="440" />
              <mxPoint x="1510" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge10" edge="1" parent="1" source="inventory-repo" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;curved=0;" target="h2-delivery" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1510" y="640" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge12" edge="1" parent="1" source="delivery-producer" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;curved=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="h2-delivery" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1120" y="640" />
            </Array>
            <mxPoint x="1260" y="560" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="edge13" edge="1" parent="1" source="delivery-consumer" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=0;" target="delivery-producer" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1140" y="460" />
              <mxPoint x="1120" y="460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge14" edge="1" parent="1" source="delivery-producer" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#006EAF;endArrow=block;endFill=1;fontSize=11;fontStyle=1;curved=0;dashed=1;fillColor=#1ba1e2;" target="topic-validated" value="OrderValidatedEvent">
          <mxGeometry relative="1" x="-0.4444" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="930" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge15" edge="1" parent="1" source="topic-validated" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#006EAF;endArrow=block;endFill=1;fontSize=11;fontStyle=1;curved=0;dashed=1;fillColor=#1ba1e2;" target="order-consumer" value="OrderValidatedEvent">
          <mxGeometry relative="1" x="-0.3134" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="850" y="560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge16" edge="1" parent="1" source="order-consumer" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;endArrow=block;endFill=1;fontSize=10" target="order-repo" value="update status">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="legend-box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;dashPattern=8 8" value="" vertex="1">
          <mxGeometry height="140" width="1630" x="10" y="760" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" value="Leyenda" vertex="1">
          <mxGeometry height="30" width="100" x="80" y="775" as="geometry" />
        </mxCell>
        <mxCell id="legend-event" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" value="Eventos Kafka" vertex="1">
          <mxGeometry height="30" width="120" x="80" y="815" as="geometry" />
        </mxCell>
        <mxCell id="legend-service" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10" value="Servicios/Lógica" vertex="1">
          <mxGeometry height="30" width="120" x="220" y="815" as="geometry" />
        </mxCell>
        <mxCell id="legend-db" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10" value="Base de Datos" vertex="1">
          <mxGeometry height="40" width="80" x="360" y="810" as="geometry" />
        </mxCell>
        <mxCell id="legend-arrow-event" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#d79b00;fontStyle=1" value="→ Eventos (Kafka)" vertex="1">
          <mxGeometry height="30" width="120" x="469" y="816" as="geometry" />
        </mxCell>
        <mxCell id="legend-arrow-normal" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="→ Llamadas internas" vertex="1">
          <mxGeometry height="30" width="120" x="605" y="816" as="geometry" />
        </mxCell>
        <mxCell id="flow-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" value="Flujo de Eventos:" vertex="1">
          <mxGeometry height="30" width="200" x="10" y="930" as="geometry" />
        </mxCell>
        <mxCell id="flow1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="1. Cliente crea orden → OrderResource" vertex="1">
          <mxGeometry height="20" width="300" x="30" y="970" as="geometry" />
        </mxCell>
        <mxCell id="flow2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="2. OrderService persiste orden en H2 (status=PENDING)" vertex="1">
          <mxGeometry height="20" width="400" x="30" y="1000" as="geometry" />
        </mxCell>
        <mxCell id="flow3" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="3. OrderProducer publica OrderCreatedEvent → Kafka (createOrderService)" vertex="1">
          <mxGeometry height="20" width="500" x="30" y="1030" as="geometry" />
        </mxCell>
        <mxCell id="flow4" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="4. DeliveryConsumer recibe evento y crea orden en su BD" vertex="1">
          <mxGeometry height="20" width="400" x="30" y="1060" as="geometry" />
        </mxCell>
        <mxCell id="flow5" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="5. DeliveryService valida inventario → InventoryRepository" vertex="1">
          <mxGeometry height="20" width="400" x="30" y="1090" as="geometry" />
        </mxCell>
        <mxCell id="flow6" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="6. DeliveryConsumer actualiza estado (ACCEPTED/DENIED) en su BD" vertex="1">
          <mxGeometry height="20" width="500" x="30" y="1120" as="geometry" />
        </mxCell>
        <mxCell id="flow7" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="7. OrderValidatedProducer publica OrderValidatedEvent → Kafka (orderValidated)" vertex="1">
          <mxGeometry height="20" width="550" x="30" y="1150" as="geometry" />
        </mxCell>
        <mxCell id="flow8" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="8. OrderValidatedConsumer recibe evento y actualiza estado en orders-service BD" vertex="1">
          <mxGeometry height="20" width="600" x="30" y="1180" as="geometry" />
        </mxCell>
        <mxCell id="notes-box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;dashed=1;dashPattern=8 8" value="" vertex="1">
          <mxGeometry height="100" width="1440" x="10" y="1220" as="geometry" />
        </mxCell>
        <mxCell id="notes-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" value="Notas Técnicas:" vertex="1">
          <mxGeometry height="30" width="200" x="30" y="1230" as="geometry" />
        </mxCell>
        <mxCell id="note1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="• Cada servicio tiene su propia base de datos H2 independiente" vertex="1">
          <mxGeometry height="20" width="400" x="30" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="note2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="• Los eventos se serializan/deserializan como JSON usando Jackson" vertex="1">
          <mxGeometry height="20" width="400" x="450" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="note3" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="• Comunicación asíncrona mediante SmallRye Reactive Messaging" vertex="1">
          <mxGeometry height="20" width="400" x="870" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="note4" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="• Idempotencia básica implementada en DeliveryConsumer" vertex="1">
          <mxGeometry height="20" width="400" x="30" y="1285" as="geometry" />
        </mxCell>
        <mxCell id="note5" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10" value="• orders-service: puerto 8080 | stock-service: puerto 8081" vertex="1">
          <mxGeometry height="20" width="400" x="450" y="1285" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
